{"remainingRequest":"/home/sium/city_bus/frontend/citybus/node_modules/babel-loader/lib/index.js!/home/sium/city_bus/frontend/citybus/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/sium/city_bus/frontend/citybus/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/home/sium/city_bus/frontend/citybus/src/views/Login.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/sium/city_bus/frontend/citybus/src/views/Login.vue","mtime":1635777714913},{"path":"/home/sium/city_bus/frontend/citybus/babel.config.js","mtime":1635395796301},{"path":"/home/sium/city_bus/frontend/citybus/node_modules/cache-loader/dist/cjs.js","mtime":1635395789697},{"path":"/home/sium/city_bus/frontend/citybus/node_modules/babel-loader/lib/index.js","mtime":1635395790311},{"path":"/home/sium/city_bus/frontend/citybus/node_modules/cache-loader/dist/cjs.js","mtime":1635395789697},{"path":"/home/sium/city_bus/frontend/citybus/node_modules/vue-loader-v16/dist/index.js","mtime":1635395790304}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3NpdW0vY2l0eV9idXMvZnJvbnRlbmQvY2l0eWJ1cy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdMb2dpbicsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJuYW1lOiAnJywKICAgICAgcGFzc3dvcmQ6ICcnCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc3VibWl0OiBmdW5jdGlvbiBzdWJtaXQoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBmb3JtZGF0YTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBmb3JtZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IF90aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICBwYXNzd29yZDogX3RoaXMucGFzc3dvcmQKICAgICAgICAgICAgICAgIH07IC8vY29uc29sZS5sb2coZm9ybWRhdGEpCgogICAgICAgICAgICAgICAgZGVsZXRlIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyJBdXRob3JpemF0aW9uIl07CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KCdhcGkvYXV0aC90b2tlbi9sb2dpbi8nLCBmb3JtZGF0YSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlcy5kYXRhWydhdXRoX3Rva2VuJ107IC8vIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd1c2VyJyxyZXMuZGF0YSkKCiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd1c2VyJyxyZXMuZGF0YSkKICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Rva2VuJywgdG9rZW4pOwogICAgICAgICAgICAgICAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnQXV0aG9yaXphdGlvbiddID0gIlRva2VuICIgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKTsKICAgICAgICAgICAgICAgICAgYXhpb3MuZ2V0KCdhcGkvYXV0aC91c2Vycy9tZS8nKS50aGVuKGZ1bmN0aW9uIChyZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuJHN0b3JlLmRpc3BhdGNoKCd1c2VyJywgcmVzLmRhdGEpOwoKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfdGhpcy4kc3RvcmUuc3RhdGUudXNlci51c2VybmFtZSk7IC8vIHRoaXMuJHJvdXRlci5wdXNoKCcvJykKICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgICAgICAgfSk7IC8vY29uc29sZS5sb2codGhpcy4kc3RvcmUuc3RhdGUudXNlci5hdXRoX3Rva2VuKQogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["/home/sium/city_bus/frontend/citybus/src/views/Login.vue"],"names":[],"mappings":";;AAuCA,OAAO,KAAP,MAAkB,OAAlB;AACA,eAAe;AACX,EAAA,IAAI,EAAC,OADM;AAGX,EAAA,IAHW,kBAGL;AACF,WAAM;AACF,MAAA,QAAQ,EAAC,EADP;AAEF,MAAA,QAAQ,EAAC;AAFP,KAAN;AAIH,GARU;AASX,EAAA,OAAO,EAAC;AACE,IAAA,MADF,oBACU;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACJ,gBAAA,QADI,GACO;AACb,kBAAA,QAAQ,EAAC,KAAI,CAAC,QADD;AAEb,kBAAA,QAAQ,EAAC,KAAI,CAAC;AAFD,iBADP,EAKV;;AACA,uBAAQ,KAAK,CAAC,QAAN,CAAe,OAAf,CAAuB,MAAvB,CAA8B,eAA9B,CAAR;AANU;AAAA,uBAOJ,KAAK,CAAC,IAAN,CAAW,uBAAX,EAAmC,QAAnC,EACL,IADK,CACA,UAAA,GAAE,EAAK;AACT,sBAAM,KAAI,GAAI,GAAG,CAAC,IAAJ,CAAS,YAAT,CAAd,CADS,CAET;;AAAA;AACA,kBAAA,YAAY,CAAC,OAAb,CAAqB,OAArB,EAA6B,KAA7B;AACA,kBAAA,KAAK,CAAC,QAAN,CAAe,OAAf,CAAuB,MAAvB,CAA8B,eAA9B,IAAkD,WAAa,YAAY,CAAC,OAAb,CAAqB,OAArB,CAA/D;AACA,kBAAA,KAAK,CAAC,GAAN,CAAU,oBAAV,EACC,IADD,CACM,UAAA,IAAG,EAAK;AACV,oBAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,MAArB,EAA4B,GAAG,CAAC,IAAhC;;AACA,oBAAA,OAAO,CAAC,GAAR,CAAY,KAAI,CAAC,MAAL,CAAY,KAAZ,CAAkB,IAAlB,CAAuB,QAAnC,EAFU,CAGV;AACH,mBALD,EAMC,IAND,CAMM,UAAA,GAAE,EAAK;AACT,oBAAA,OAAO,CAAC,GAAR,CAAY,GAAZ;AACH,mBARD,EALS,CAcT;AACH,iBAhBK,EAiBL,IAjBK,CAiBA,UAAA,GAAE,EAAK;AACT,kBAAA,OAAO,CAAC,GAAR,CAAY,GAAZ;AACH,iBAnBK,CAPI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA2Bd;AA5BI;AATG,CAAf","sourcesContent":["<template>\n    <div class=\"container\">\n        <div class=\"card\" style=\"width: 30rem;\">\n        <div class=\"card-header my-3\">\n            <h2>Login</h2>\n        </div>\n        <div class=\"card-body\">\n            <form @submit.prevent=\"submit\">\n                <div class=\"mb-3\">\n                    <label for=\"exampleInputEmail1\" class=\"form-label\">Username</label>\n                    <input type=\"text\" v-model=\"username\" class=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\">\n                    <div id=\"emailHelp\" class=\"form-text\">We'll never share your email with anyone else.</div>\n                </div>\n                <div class=\"mb-3\">\n                    <label for=\"exampleInputPassword1\" class=\"form-label\">Password</label>\n                    <input type=\"password\" v-model=\"password\" class=\"form-control\" id=\"exampleInputPassword1\">\n                </div>\n                <div class=\"mb-3 form-check\">\n                    <input type=\"checkbox\" class=\"form-check-input\" id=\"exampleCheck1\">\n                    <label class=\"form-check-label\" for=\"exampleCheck1\">Remeber me</label>\n\n                </div>\n                <div class=\"mb-3 \">\n                    <span>Not a member? </span>\n                    <router-link to='/register'>\n                    Register\n                    </router-link>\n\n                </div>\n\n                <button type=\"submit\" class=\"btn btn-primary\">Submit</button>\n            </form>\n            \n        </div>\n    </div>\n    </div>\n    <router-view></router-view>\n</template>\n<script>\nimport axios from 'axios'\nexport default {\n    name:'Login',\n\n    data(){\n        return{\n            username:'',\n            password:''\n        }\n    },\n    methods:{\n        async submit(){\n            const formdata = {\n                username:this.username,\n                password:this.password\n            }\n            //console.log(formdata)\n            delete  axios.defaults.headers.common[\"Authorization\"];\n            await axios.post('api/auth/token/login/',formdata)\n            .then(res => {\n                const token = res.data['auth_token']\n                // this.$store.dispatch('user',res.data)\n                localStorage.setItem('token',token)\n                axios.defaults.headers.common['Authorization'] =  \"Token \"  +  localStorage.getItem('token')\n                axios.get('api/auth/users/me/')\n                .then(ress => {\n                    this.$store.dispatch('user',res.data)\n                    console.log(this.$store.state.user.username)\n                    // this.$router.push('/')\n                })\n                .then(err => {\n                    console.log(err)\n                })\n                //console.log(this.$store.state.user.auth_token)\n            })\n            .then(err => {\n                console.log(err)\n            })\n        }\n    }\n}\n</script>\n<style>\n.container{\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    \n}\n.card{\n    margin-top: 3rem;\n} \nh2{\n    font-weight: 900;\n}\n</style>"],"sourceRoot":""}]}